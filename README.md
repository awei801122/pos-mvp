# 自助點餐 POS 系統

## 專案概述

本專案旨在開發一套自助點餐 POS 系統,為餐飲業者提供一個高效、易用的點餐管理解決方案。該系統主要面向中小型餐廳、咖啡廳等商家,幫助他們實現:

- 無人點餐: 顧客可以通過前台觸控螢幕自助點餐,減少人工成本。
- 訂單管理: 後台可以高效管理訂單,包括接單、出餐、訂單修改等。
- 叫號系統: 系統支援叫號功能,顧客取餐更方便。
- 報表統計: 自動生成日結報表,幫助商家掌握經營數據。
- 菜單管理: 商家可以輕鬆設定和調整菜單內容,包括菜品、價格、選項等。
- 庫存管理: 追蹤原物料使用情況,管理庫存和成本。
- 權限控制: 區分管理員、店員和消費者不同權限。

本系統採用前後端分離架構,前端使用 Electron 構建跨平台的桌面應用程式,支援 Windows 和 macOS 系統。後端使用 PHP 搭建伺服器,負責資料處理和存儲。

## 核心功能

### 1. 使用者登入介面
- 多層級使用者權限系統(管理員、店員、消費者)
- 安全的認證授權機制
- 月租收費模式的授權驗證
- 與本地端主機連線認證

### 2. 菜單管理
- 商品新增、編輯和刪除
- 商品上架/下架功能
- 商品圖片上傳
- 商品分類和標籤管理
- 商品定價和特價設定

### 3. 庫存與原物料管理
- 庫存水位監控
- 原物料成本計算
- 保存期限追蹤
- 進貨和耗材記錄
- 庫存警報通知

### 4. 權限管理
- 多角色系統(管理員、店員、消費者)
- 功能權限控制
- 資料訪問權限控制
- 操作日誌記錄

### 5. 訂單管理
- 訂單狀態追蹤
- 後廚出餐介面
- 叫號系統(call.html)
- 電子發票整合(選填功能)
- 訂單歷史記錄和查詢
- 訂單修改和取消

### 6. 銷售報表
- 日/週/月/年銷售數據統計
- 商品銷售分析
- 營業額和毛利分析
- 數據匯出功能(Excel, CSV)
- 圖表化數據展示

### 7. 點餐介面
- 直覺的商品瀏覽
- 購物車功能
- 訂單確認和修改
- 訂單編號和收據列印
- 客人取餐號碼牌顯示

## 安裝與執行

### 前置需求

- 作業系統: Windows 7+ / macOS 10.12+
- Node.js: v14.x+
- PHP: 7.4+
- Composer: 2.x+

### 安裝依賴項

在專案根目錄下,運行以下命令安裝前端依賴項:

```bash
npm install
```

在 `kiosk/` 目錄下,運行以下命令安裝後端依賴項:

```bash
composer install
```

### 啟動專案

首先,啟動後端 API 伺服器。在 `kiosk/` 目錄下運行:

```bash
php -S 0.0.0.0:8000
```

然後,啟動前端開發伺服器。在專案根目錄下運行:

```bash
npm start
```

現在,你可以在瀏覽器中訪問 `http://192.168.1.105:8000` 來使用本應用程式了。


## 系統架構

### 前端技術棧

我們選擇使用 Electron 作為前端框架,主要考慮到以下幾點:

- Electron 允許我們使用 Web 技術(HTML, CSS, JavaScript)來構建跨平台的桌面應用程式,學習成本相對較低。
- Electron 提供了豐富的 API,可以方便地訪問本地資源,如檔案系統、系統通知等,這對於我們的應用程式非常重要。
- Electron 有著活躍的社群和完善的文件,可以幫助我們快速解決開發中遇到的問題。
- 使用 Electron,我們可以輕鬆地將 Web 應用程式打包成可執行檔,簡化了部署和分發的流程。

### 後端技術棧

在後端,我們決定使用 PHP,主要基於以下考量:

- PHP 是一種成熟、穩定的伺服器端語言,有著廣泛的應用和豐富的生態系統。
- PHP 特別適合 Web 開發,提供了很多內建的 Web 相關功能,如 Session 管理、表單處理等。
- PHP 有著優秀的效能,尤其是在處理併發請求時。這對於我們的點餐系統非常重要。
- 團隊成員普遍具備 PHP 開發經驗,這將有助於專案的順利進行。


主要的 JSON 檔案包括:
- config.json: 系統設定
- menu.json: 菜單資料
- users.json: 使用者資料
- orders.json: 訂單歷史
- queue.json: 叫號佇列
- inventory.json: 庫存資料

### 系統部署

+------------------+         +----------------+         +-----------------+
|                  |         |                |         |                 |
|  Electron 前端   |  <----> |   PHP 後端     |  <----> |   JSON 檔案儲存 |
|                  |         |                |         |                 |
+------------------+         +----------------+         +-----------------+
        |                                                         |
        |                                                         |
        v                                                         v
  +------------+                                           +-------------+
  |            |                                           |             |
  | 本地資源   |                                           | 本地/雲端   |
  |            |                                           |             |
  +------------+                                           +-------------+ 

## 專案結構

本專案的目錄結構如下:

- `README.md`: 專案說明文件,包含專案概述、安裝指南、使用方法等。
- `package.json`: 專案的設定檔,記錄了專案的基本資訊、依賴項、指令碼等。
- `main.js`: Electron 應用程式的主程序。
- `preload.js`: Electron 的預載腳本。
- `config.json`: 全域設定檔案。
- `kiosk/api`: 後端 PHP 程式碼目錄
  - `auth.php`: 處理使用者認證和授權。
  - `menu.php`: 處理菜單管理相關操作。
  - `inventory.php`: 處理庫存和原物料管理。
  - `save_order.php`: 處理訂單保存。
  - `kitchen.php`: 處理廚房管理。
  - `queue.php`: 處理叫號佇列管理。
  - `reports.php`: 生成各種報表。
  - `invoice.php`: 處理電子發票相關操作。
  - `data/`: 資料檔案目錄
    - `config.json`: 系統設定檔案。
    - `menu.json`: 菜單資料檔案。
    - `users.json`: 使用者資料檔案。
    - `orders.json`: 訂單歷史檔案。
    - `queue.json`: 叫號佇列檔案。
    - `inventory.json`: 庫存資料檔案。
  - `logs/`: 日誌檔案目錄
- `ui/`: 前端 UI 程式碼目錄
  - `login.html`: 登入頁面。
  - `admin.html`: 後台管理頁面。
  - `order.html`: 點餐頁面。
  - `menu-edit.html`: 菜單編輯頁面。
  - `inventory.html`: 庫存管理頁面。
  - `call.html`: 叫號系統頁面。
  - `sales-report.html`: 銷售報表頁面。
  - `config-ui.html`: 設定頁面。
  - `css/`: CSS 樣式表目錄。
  - `js/`: JavaScript 檔案目錄
    - `login.js`: 登入頁面的交互邏輯。
    - `admin.js`: 後台管理頁面的交互邏輯。
    - `order.js`: 點餐頁面的交互邏輯。
    - `menu.js`: 菜單管理頁面的交互邏輯。
    - `inventory.js`: 庫存管理頁面的交互邏輯。
    - `call.js`: 叫號系統頁面的交互邏輯。
    - `report.js`: 報表頁面的交互邏輯。
  - `img/`: 圖片資源目錄。
- `docs/`: 專案文件目錄
  - `PROJECT_STATUS.md`: 專案進度報告。
  - `mac伺服器啟動.md`: 在 macOS 上啟動伺服器的說明。
- `node_modules/`: Node.js 的依賴項目錄
- `.gitignore`: Git 忽略規則檔案
- `.editorconfig`: 編輯器設定檔案
- `.eslintrc.json`: ESLint 設定檔案
- `.prettierrc`: Prettier 設定檔案
- `vite.config.ts`: Vite 設定檔案
- `tsconfig.json`: TypeScript 設定檔案

## 開發指南

為了確保專案的程式碼品質和協作效率,我們制定了以下開發規範,所有參與本專案的開發者都需要遵守。

### 程式碼風格

我們遵循以下程式碼風格規範:

- 縮排:使用 4 個空格,不使用 Tab。
- 變數命名:使用語義化的英文單詞,採用小駝峰式命名法(`camelCase`)。
- 函式命名:使用語義化的英文單詞,採用小寫加下劃線的命名法(`snake_case`)。
- 類命名:使用語義化的英文單詞,採用大駝峰式命名法(`PascalCase`)。
- 常量命名:全部使用大寫字母,單詞之間用下劃線分隔(`SNAKE_CASE`)。
- 每行程式碼不超過 80 個字元。
- 所有程式需加上中英對照註解（中文為主，英文輔助）。

### 通用規則

1. 所有路徑皆使用相對路徑（避免硬編 IP）。
2. 所有程式需加上中英對照註解（中文為主，英文輔助）。
3. 所有邏輯應模組化、易於維護與未來擴充。

### 前端規則（JavaScript + HTML）

1. JS 檔案命名風格使用 camelCase。
2. 函式名稱使用 snake_case。
3. 使用 vanilla JS，不引入 jQuery 等第三方框架。
4. 使用 fetch 請求後端 PHP，並處理 JSON 檔案。
5. config 設定需從 config.json 讀取，允許前端修改。
6. 所有前端檔案統一放在 `ui/` 資料夾中，保持結構清晰。

### 後端規則（PHP）

1. 使用 PHP 內建伺服器 `php -S 0.0.0.0:8000 -t kiosk`。
2. 所有 PHP 檔案放在 `kiosk/api` 資料夾中。
3. 包含 auth.php（認證授權）、save_order.php（訂單處理）、kitchen.php（廚房管理）等。
4. 儲存檔案與讀寫 SQL 檔案需確保資料一致性。
5. 所有 PHP 檔案需具備清楚的錯誤處理與輸出格式（JSON 回應）。
6. 實作權限系統，區分管理員、店員、消費者三種角色。

## 開發順序建議

1. 登入與權限系統：建立使用者認證和授權機制，確保系統安全。
2. 菜單管理系統：允許店家設定和管理菜單項目。
3. 庫存與原物料管理：追蹤庫存水位和原物料成本。
4. 點餐流程實作：建立直覺的點餐介面，包含購物車功能。
5. 訂單管理與叫號功能：實現後廚訂單處理和客人叫號系統。
6. 銷售報表系統：提供資料分析和報表匯出功能。
7. 電子發票整合：加入電子發票開立功能（選填項目）。

## 部署流程

### 開發環境

在開發環境中直接運行：

```bash
# 啟動 PHP 後端
cd kiosk/
php -S 0.0.0.0:8000

# 另一個終端啟動前端
npm start
```

### 生產環境

建立可執行檔：

```bash
# 打包 Electron 應用
npm run build
```

這將產生一個可執行的應用程式，可以在 Windows 或 macOS 上運行。 